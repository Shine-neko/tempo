language: php

php:
  - 5.3

env:
  - SYMFONY_VERSION=origin/2.1 DB=mysql

before_script:
  - echo "Starting install" > install.log

  # Setup Database
  - cp app/config/parameters.yml.dist app/config/parameters.yml
  - sh -c "if [ '$DB' = 'mysql' ]; then mysql -e 'CREATE DATABASE IF NOT EXISTS tempo_demo;'; fi" >> install.log

  # Setup code

  - wget http://getcomposer.org/composer.phar
  - php composer.phar install >> install.log
  - mkdir -p app/cache app/logs
  - sudo chmod -R 777 app/cache app/logs


  # Setup fixtures
  - cp tests/travis/parameters.yml app/config/parameters.yml >> install.log

script:
    - phpunit -c app/
    - ./bin/behat-ci.sh